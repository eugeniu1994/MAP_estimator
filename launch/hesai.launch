<launch>
    <arg name="bag_file" default="/media/eugeniu/T7/2024-03-07-14-40-23.bag"/>
    
    
    <arg name="rviz" default="true" />
    <arg name="rviz_car" default="true" />

    <rosparam command="load" file="$(find map_lio)/config/hesai.yaml" />
<!-- 3 -->
    <param name="Bag" type="string" value="$(arg bag_file)" />
    <param name="filter_size_surf" type="double" value=".5" />  
    <param name="filter_size_map" type="double" value=".5" />   
    
    <node pkg="map_lio" type="estimate_map" name="estimate_map" output="screen" /> 


    <group if="$(arg rviz)">
        <group if="$(arg rviz_car)">
            <include file="$(find map_lio)/launch/robot_car.launch">
                <arg name="fixed_frame" value="MLS"/>
            </include>
        </group>
        <node launch-prefix="nice" pkg="rviz" type="rviz" name="rviz" args="-d $(find map_lio)/rviz_cfg/visualize.rviz" /> 
    </group>

    <node pkg="hector_trajectory_server" type="hector_trajectory_server" name="trajectory_server" ns="MLS" >
        <param name="/target_frame_name" value="world" />
        <param name="/source_frame_name" value="MLS" />
        <param name="/trajectory_update_rate" value="250.0" />
        <param name="/trajectory_publish_rate" value="250.0" />
    </node>

    <node pkg="hector_trajectory_server" type="hector_trajectory_server" name="trajectory_server_GPSFix" ns="GPSFix" >
        <param name="/target_frame_name" value="world" />
        <param name="/source_frame_name" value="GPSFix" />
        <param name="/trajectory_update_rate" value="15.0" />
        <param name="/trajectory_publish_rate" value="15.0" />
    </node>
    
</launch>
